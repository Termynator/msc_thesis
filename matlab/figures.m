clear all;
% training plots
acc_1_train = [0.496875
0.5
0.54375
0.55
0.540625
0.5375
0.515625
0.5875
0.565625
0.575
0.559375
0.615625
0.6125
0.63125
0.63125
0.684375
0.6875
0.74375
0.740625
0.7
0.78125
0.771875
0.815625
0.790625
0.8125
0.8125
0.684375
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.615625
0.690625
0.709375];


acc_1_test = [0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5125
0.5
0.5
0.5
0.5
0.4875
0.475
0.5
0.5
0.4875
0.4875
0.525
0.5125
0.5125
0.5
0.45
0.5
0.5125
0.4875
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5
0.5125
0.525
];

lss_1_train = [5170.78
4.22009
2.42635
2.13588
2.14392
2.12885
2.15465
2.10668
2.1001
2.10637
2.07404
2.01489
1.9986
1.97897
1.96007
1.88447
1.89806
1.78192
1.7996
1.79534
1.64751
1.60381
1.52082
1.48438
1.47974
1.3959
7.46183
4.11655
4.09332
4.08281
4.05036
4.05766
4.04057
4.0043
4.0163
3.98294
3.97171
3.93556
3.95133
3.94052
3.87141
3.91611
3.85883
3.8437
3.95873
3.91945
3.86569
2.17635
1.8642
1.8397
];

lss_1_test = [5.07654
4.42754
2.41117
2.47963
2.46377
2.51925
2.35931
2.34844
2.40458
2.37621
2.4515
2.49833
2.38975
2.42158
2.54469
2.60904
2.68963
2.73865
2.63648
2.49367
2.65263
3.25433
2.99817
3.22485
2.68798
2.95017
4.50577
4.52935
4.47183
4.45398
4.52752
4.50729
4.60758
4.6201
4.91031
4.65442
4.51854
4.4784
4.40046
4.41923
4.86581
4.81867
4.61498
4.94775
4.63881
4.77973
4.31629
2.78092
2.75996
2.54017
];

acc_2_train = [0.49375
0.49375
0.515625
0.50625
0.50625
0.50625
0.50625
0.50625
0.50625
0.55625
0.653125
0.690625
0.728125
0.759375
0.78125
0.81875
0.828125
0.79375
0.840625
0.8375
0.85625
0.89375
0.8
0.884375
0.89375
0.915625
0.925
0.90625
0.946875
0.925
0.95
0.95
0.934375
0.9375
0.928125
0.95
0.94375
0.95625
0.9375
0.95625
0.953125
0.946875
0.9625
0.971875
0.975
0.98125
0.98125
0.975
0.978125
0.98125
];

acc_2_test = [0.525
0.525
0.475
0.475
0.475
0.475
0.475
0.475
0.475
0.475
0.725
0.8
0.7125
0.7875
0.825
0.8625
0.875
0.8625
0.825
0.85
0.875
0.8375
0.8625
0.8875
0.9125
0.8875
0.7875
0.875
0.9125
0.925
0.925
0.8875
0.925
0.9
0.925
0.8
0.875
0.8875
0.8125
0.9
0.85
0.9
0.9
0.9
0.9
0.925
0.9
0.9
0.925
0.925
];

lss_2_train = [2262.59
6.16667
16.1201
4.04058
4.00231
3.96042
5.49838
4.00867
3.90434
2.42007
1.97116
1.88027
1.77126
1.72889
1.63727
1.4638
1.32365
1.47062
1.24399
1.10916
1.06138
0.972438
1.40768
0.868891
0.805208
0.753276
0.657885
0.858281
0.578932
0.616177
0.59526
0.538266
0.645292
0.575672
0.700719
0.478927
0.516219
0.447875
0.595104
0.432594
0.4875
0.463526
0.370344
0.348307
0.308578
0.268729
0.276224
0.298854
0.278708
0.260146
];

lss_2_test = [6.16667
6.16667
4.14113
4.12898
4.09238
4.01427
4.41235
4.04565
3.91546
2.06673
1.86658
1.73296
1.78552
1.56633
1.44146
1.40873
1.10679
1.07525
1.08817
1.01985
0.799229
0.998
1.03692
0.836938
0.685771
0.97625
1.47773
0.816271
0.718208
0.590312
0.725042
0.778
0.679333
0.728
0.614708
1.38833
0.838937
0.876354
1.31492
0.8295
1.15106
0.820479
0.764792
0.788958
0.744854
0.657146
0.66525
0.756875
0.596625
0.672312
];

epoch = [1:50];

figure(1)
subplot(2,1,1)
plot(epoch,acc_1_test,epoch,acc_1_train,epoch,acc_2_test,epoch,acc_2_train)
lgd = legend('Exp 1 test','Exp 1 train','Exp 2 test','Exp 2 train');
lgd.Location = 'northwest';
title('Classification Accuracy')
xlabel('Epoch')
ylabel('Accuracy')
subplot(2,1,2)
semilogy(epoch,lss_1_test,epoch,lss_1_train,epoch,lss_2_test,epoch,lss_2_train)
title('Classification Loss')
xlabel('Epoch')
ylabel('Spike Count Loss')
lgd = legend('Exp 1 test','Exp 1 train','Exp 2 test','Exp 2 train');
lgd.Location = 'northwest';
%sgtitle('Subplot Grid Title')


A_scn = load('A_dc_subject_001_DATA.mat').D;
A_spk = niftiread('A_dc_subject_001.nii');
A_spk_sm = sum(A_spk,3);

A_scn = squeeze(A_scn(1,:,:));
A_spk = A_spk(:,:,50);

figure(2)
subplot(1,3,1)
imshow(squeeze(A_scn),[])
title('Simulated fMRI Frame')
subplot(1,3,2)
imshow(A_spk,[])
title('Spike Encoded Frame')
subplot(1,3,3)
imshow(A_spk_sm,[])
title('Spike Tensor Sum')






